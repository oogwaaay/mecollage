<!DOCTYPE html>
<html lang="x-default">
<head>
    <meta charset="UTF-8">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rounded Corners - Free Online Image Corner Rounding Tool</title>
    <meta name="description" content="Add rounded corners to images online for free. Adjust corner radius with slider (0-50%). Download in PNG, JPG formats. Perfect for profile pictures, buttons, and modern designs.">
    <meta name="keywords" content="rounded corners, image rounded corners, round corners online, corner rounding tool, rounded image, online corner editor, rounded photo">
    <link rel="canonical" href="https://www.mecollage.top/public/tools/roundedcorners/">
    <!-- DNS Prefetch for external resources -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <!-- Preconnect for fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Preload critical resources -->
    <link rel="preload" href="/wallImage.webp" as="image" type="image/webp" fetchpriority="high">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Early WebP detection -->
    <script>
        (function() {
            const init = () => {
                const webP = new Image();
                webP.onload = webP.onerror = function() {
                    const isSupported = webP.height === 2;
                    if (isSupported) {
                        document.documentElement.classList.add('webp-supported');
                        document.documentElement.style.setProperty('--placeholder-icon-url', 'url(/placeholder-icon.webp)');
                    } else {
                        document.documentElement.style.setProperty('--placeholder-icon-url', 'url(/placeholder-icon.png)');
                    }
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', setBackgroundImage, { once: true });
                    } else {
                        setBackgroundImage();
                    }
                };
                webP.src = 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';
            };

            function setBackgroundImage() {
                const bgElement = document.querySelector('.ghibli-background');
                if (bgElement) {
                    const isWebP = document.documentElement.classList.contains('webp-supported');
                    bgElement.style.backgroundImage = isWebP ? 'url(/wallImage.webp)' : 'url(/wallImage.png)';
                }
            }

            if ('requestIdleCallback' in window) {
                window.requestIdleCallback(init);
            } else {
                window.addEventListener('load', init, { once: true });
            }
        })();
    </script>
    <!-- Main CSS -->
    <link rel="stylesheet" href="/assets/index-vAuRGWiM.css">
    <link rel="stylesheet" href="/assets/pages-C2UaL6ML.css">
    <!-- Custom CSS for Rounded Corners Tool -->
    <style>
        /* Rounded Corners Tool Specific Styles */
        .rounded-tool-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #8fd68f;
            text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.6),
                         0 0 30px rgba(0, 0, 0, 0.4);
            text-align: center;
        }

        .page-subtitle {
            font-size: 1.2rem;
            color: #8fd68f;
            text-align: center;
            margin-bottom: 3rem;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);
            background: rgba(0, 0, 0, 0.25);
            display: inline-block;
            padding: 0.6rem 1.8rem;
            border-radius: 20px;
            backdrop-filter: blur(8px);
        }

        .tool-nav {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(18px);
            border-radius: 30px;
            padding: 1rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.18);
            margin-bottom: 2rem;
        }

        .tool-nav-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .tool-nav-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tool-nav-link:hover {
            background-color: rgba(143, 214, 143, 0.2);
            border-color: rgba(143, 214, 143, 0.4);
            color: #8fd68f;
            transform: translateY(-2px);
        }

        .tool-nav-link.active {
            background-color: rgba(143, 214, 143, 0.3);
            border-color: rgba(143, 214, 143, 0.6);
            color: #8fd68f;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .preview-section {
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(18px);
            border-radius: 30px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.18);
            text-align: center;
        }

        .upload-area {
            border: 2px dashed #8fd68f;
            border-radius: 20px;
            padding: 40px 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
        }

        .upload-area:hover {
            border-color: #66BB6A;
            background-color: rgba(143, 214, 143, 0.1);
        }

        .upload-icon {
            font-size: 4rem;
            color: #8fd68f;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        #fileInput {
            display: none;
        }

        .canvas-container {
            position: relative;
            margin: 20px auto;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
        }

        #previewCanvas {
            display: block;
            margin: 0 auto;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .radius-control {
            margin: 20px 0;
        }

        .radius-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
        }

        .radius-slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .radius-slider {
            flex: 1;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #8fd68f;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: #66BB6A;
            transform: scale(1.2);
        }

        .radius-value {
            font-weight: 700;
            color: #8fd68f;
            font-size: 1.2rem;
            min-width: 60px;
        }

        .radius-preview {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }

        .radius-preview-item {
            width: 50px;
            height: 50px;
            background-color: #8fd68f;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(0, 0, 0, 0.8);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .radius-preview-item:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .radius-preview-item.active {
            border-color: rgba(255, 255, 255, 0.6);
            background-color: #66BB6A;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
        }

        .btn-primary {
            background: #8fd68f;
            color: #1a1a1a;
            box-shadow: 0 8px 24px rgba(143, 214, 143, 0.3);
        }

        .btn-primary:hover {
            background: #66BB6A;
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(143, 214, 143, 0.4);
        }

        .btn-secondary {
            background: rgba(0, 0, 0, 0.4);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        .settings-section {
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(18px);
            border-radius: 30px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s ease;
            transform: translateY(10px);
            opacity: 0;
            visibility: hidden;
            height: 0;
            overflow: hidden;
        }

        .settings-section.active {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
            height: auto;
            overflow: visible;
        }

        .settings-section h3 {
            margin-bottom: 20px;
            color: #8fd68f;
            font-size: 1.5rem;
            font-weight: 700;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
        }

        .setting-group {
            margin-bottom: 25px;
        }

        .setting-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        select, input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.3);
            color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }

        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: rgba(143, 214, 143, 0.6);
            box-shadow: 0 0 0 3px rgba(143, 214, 143, 0.2);
        }

        select option {
            background: #333;
            color: #fff;
        }

        .quality-slider {
            margin: 15px 0;
        }

        .download-info {
            background: rgba(143, 214, 143, 0.15);
            border: 1px solid rgba(143, 214, 143, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        footer {
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        footer a {
            color: #8fd68f;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        /* FAQ Section Styles */
        .faq-section {
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(18px);
            border-radius: 30px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.18);
            margin: 2rem 0;
        }

        .faq-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: #8fd68f;
            text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.6),
                         0 0 30px rgba(0, 0, 0, 0.4);
            text-align: center;
        }

        .faq-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .faq-item {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .faq-question {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .faq-answer {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        footer a:hover {
            color: #66BB6A;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .settings-section {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .rounded-tool-container {
                padding: 1rem;
            }

            .page-title {
                font-size: 2rem;
            }

            .page-subtitle {
                font-size: 1rem;
                padding: 0.5rem 1.2rem;
            }

            .upload-area {
                padding: 30px 15px;
            }

            .upload-icon {
                font-size: 3rem;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .radius-slider-container {
                flex-direction: column;
                align-items: stretch;
            }

            .radius-value {
                text-align: center;
            }

            .tool-nav-container {
                flex-direction: column;
                align-items: center;
            }

            .tool-nav-link {
                width: 100%;
                max-width: 200px;
                text-align: center;
            }
        }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9280689992387509" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Ghibli Background -->
    <div class="ghibli-background">
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
        <div class="cloud cloud3"></div>
        <div class="cloud cloud4"></div>
        <div class="sun"></div>
        <div class="bird bird1">üê¶</div>
        <div class="bird bird2">üê¶</div>
        <div class="tree tree1">
            <div class="tree-trunk"></div>
            <div class="tree-foliage"></div>
        </div>
        <div class="tree tree2">
            <div class="tree-trunk"></div>
            <div class="tree-foliage"></div>
        </div>
        <div class="tree tree3">
            <div class="tree-trunk"></div>
            <div class="tree-foliage"></div>
        </div>
        <div class="tree tree4">
            <div class="tree-trunk"></div>
            <div class="tree-foliage"></div>
        </div>
    </div>

    <div class="app-container">
        <!-- Main Navigation (Inherited from Main Site) -->
        <nav class="ghibli-nav">
            <div class="nav-left">
                <a href="/" class="nav-link" data-page="home" data-i18n="nav.home">Home</a>
                <a href="/blog/" class="nav-link" data-page="blog">Blog</a>
                <a href="/about" class="nav-link" data-page="about">About</a>
                <a href="/public/tools/square/" class="nav-link" data-page="square" data-i18n="nav.square" rel="noopener noreferrer">Square Image</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/oogwaaay/mecollage/issues" 
                   target="_blank" 
                   rel="noopener noreferrer" 
                   class="nav-link github-link" 
                   title="View on GitHub">
                    <i class="fab fa-github"></i> GitHub
                </a>
                <div class="lang-selector" title="Switch Language">
                    <button type="button" class="lang-selector-toggle" aria-haspopup="true" aria-expanded="false">
                        <span aria-hidden="true">üåê</span>
                        <span data-i18n="lang.name">English</span>
                    </button>
                    <div class="lang-menu" role="menu">
                        <button type="button" class="lang-option" data-lang="en" role="menuitem" data-i18n="lang.options.en">English</button>
                        <button type="button" class="lang-option" data-lang="zh" role="menuitem" data-i18n="lang.options.zh">ÁÆÄ‰Ωì‰∏≠Êñá</button>
                        <button type="button" class="lang-option" data-lang="es" role="menuitem" data-i18n="lang.options.es">Espa√±ol</button>
                    </div>
                    <div class="lang-menu-backdrop" tabindex="-1" aria-hidden="true"></div>
                </div>
            </div>
        </nav>

        <div class="rounded-tool-container">
            <header class="page-header">
                <h1 class="page-title">Rounded Corners</h1>
                <p class="page-subtitle">Add customizable rounded corners to your images with transparent backgrounds. Perfect for modern web design, profile pictures, UI elements, and app icons.</p>
            </header>

            <nav class="tool-nav">
                <div class="tool-nav-container">
                    <a href="/" class="tool-nav-link"><i class="fas fa-home"></i> Home</a>
                    <a href="/public/tools/squarecrop/" class="tool-nav-link"><i class="fas fa-crop-square"></i> Square Crop</a>
                    <a href="/public/tools/roundedcorners/" class="tool-nav-link active"><i class="fas fa-border-radius"></i> Rounded Corners</a>
                    <a href="/public/tools/square/" class="tool-nav-link"><i class="fas fa-square"></i> Square Image</a>
                    <a href="/public/tools/blurredframe/" class="tool-nav-link"><i class="fas fa-image"></i> Blurred Frame</a>
                </div>
            </nav>

            <div class="main-content">
                <section class="preview-section">
                    <div id="uploadContainer">
                        <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                            <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                            <div class="upload-text">Drag & drop an image here or click to upload</div>
                            <div class="upload-hint">Supports JPG, PNG, WEBP formats</div>
                        </div>
                        <input type="file" id="fileInput" accept="image/*">
                    </div>

                    <div id="editorContainer" style="display: none;">
                        <div class="canvas-container" id="canvasContainer">
                            <canvas id="previewCanvas"></canvas>
                        </div>

                        <div class="action-buttons" style="margin-top: 20px;">
                            <button class="btn btn-secondary" onclick="resetEditor()"><i class="fas fa-redo"></i> Reset</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()"><i class="fas fa-upload"></i> Change Image</button>
                        </div>
                    </div>
                </section>

                <aside class="settings-section" id="settingsSection">
                    <h3><i class="fas fa-cog"></i> Settings</h3>
                    
                    <div class="setting-group">
                        <label class="setting-label">Corner Radius</label>
                        <div class="radius-slider-container">
                            <div class="radius-slider">
                                <input type="range" id="radiusSlider" min="0" max="50" value="10">
                            </div>
                            <span class="radius-value" id="radiusValue">10%</span>
                        </div>
                        <div class="radius-preview">
                            <div class="radius-preview-item" style="border-radius: 0%" data-radius="0">0%</div>
                            <div class="radius-preview-item" style="border-radius: 10%" data-radius="10">10%</div>
                            <div class="radius-preview-item" style="border-radius: 25%" data-radius="25">25%</div>
                            <div class="radius-preview-item" style="border-radius: 50%" data-radius="50">50%</div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label class="setting-label">Download</label>
                        <select id="outputSize">
                            <option value="original" selected>Original</option>
                            <option value="1080">1080px</option>
                            <option value="1024">1024px</option>
                            <option value="512">512px</option>
                            <option value="custom">Custom</option>
                        </select>
                        <!-- Custom size inputs -->
                        <div id="customSizeInputs" style="display: none; margin-top: 15px; padding: 15px; background: rgba(0, 0, 0, 0.2); border-radius: 12px;">
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <div style="flex: 1; min-width: 150px;">
                                    <label class="setting-label" style="margin-bottom: 5px;">Width (px)</label>
                                    <input type="number" id="customWidth" min="1" max="8192" value="1000" style="width: 100%;">
                                </div>
                                <div style="flex: 1; min-width: 150px;">
                                    <label class="setting-label" style="margin-bottom: 5px;">Height (px)</label>
                                    <input type="number" id="customHeight" min="1" max="8192" value="1000" style="width: 100%;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label class="setting-label">Format</label>
                        <select id="outputFormat">
                            <option value="png" selected>PNG</option>
                            <option value="jpg">JPG</option>
                            <option value="webp">WEBP</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <button class="btn btn-primary" onclick="downloadImage()"><i class="fas fa-download"></i> Download Image</button>
                    </div>
                </aside>
            </div>

            <!-- FAQ Section -->
            <section class="faq-section" id="faqSection">
                <h2 class="faq-title">Frequently Asked Questions</h2>
                <div class="faq-container">
                    <div class="faq-item">
                        <h3 class="faq-question">What is Rounded Corners?</h3>
                        <p class="faq-answer">Rounded Corners is a free online tool that adds customizable rounded corners to your images with transparent backgrounds. Perfect for modern UI design, profile pictures, app icons, and web graphics that need that polished, contemporary look.</p>
                    </div>
                    <div class="faq-item">
                        <h3 class="faq-question">How does it work?</h3>
                        <p class="faq-answer">Upload your image and use the corner radius slider to adjust how rounded you want the corners (0% for square, 50% for circular). The tool outputs images with transparency outside the rounded shape, making them perfect for overlaying on any background.</p>
                    </div>
                    <div class="faq-item">
                        <h3 class="faq-question">Perfect for modern design</h3>
                        <p class="faq-answer">Rounded corners are essential in modern web and app design. Create sleek profile pictures, stylish UI elements, app icons with rounded corners, or any graphic that needs smooth, contemporary edges instead of sharp 90-degree angles.</p>
                    </div>
                    <div class="faq-item">
                        <h3 class="faq-question">Easy to use</h3>
                        <p class="faq-answer">Simply upload your image, adjust the corner radius slider, and download. The live preview shows exactly how your rounded image will look. From subtle rounding to perfect circles at 50%, you have complete control.</p>
                    </div>
                    <div class="faq-item">
                        <h3 class="faq-question">Transparent output</h3>
                        <p class="faq-answer">Download as PNG with transparent corners, or choose JPEG/WEBP if you prefer a solid background. The transparent PNG option makes it easy to use your rounded images anywhere without worrying about backgrounds.</p>
                    </div>
                    <div class="faq-item">
                        <h3 class="faq-question">Free and unlimited</h3>
                        <p class="faq-answer">Completely free with no watermarks, signup requirements, or hidden fees. Add rounded corners to unlimited images with full quality and all customization options available at no cost.</p>
                    </div>
                </div>
            </section>

            <footer>
                <p>&copy; 2024 MeCollage. All rights reserved. | <a href="/">Back to Home</a></p>
            </footer>
        </div>
    </div>

    <script>
        // State management
        const state = {
            image: null,
            canvas: null,
            ctx: null,
            radius: 10,
            containerSize: 0
        };

        // Initialize canvas
        function initCanvas() {
            state.canvas = document.getElementById('previewCanvas');
            state.ctx = state.canvas.getContext('2d');
            
            // Calculate container size based on viewport
            const calculateContainerSize = () => {
                const maxSize = Math.min(window.innerWidth - 40, window.innerHeight - 300, 800);
                state.containerSize = maxSize;
            };

            calculateContainerSize();
            window.addEventListener('resize', calculateContainerSize);
        }

        // Image upload handling
        document.getElementById('fileInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                loadImage(file);
            }
        });

        // Drag and drop support
        document.addEventListener('DOMContentLoaded', () => {
            const uploadContainer = document.getElementById('uploadContainer');
            
            uploadContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadContainer.classList.add('drag-over');
            });

            uploadContainer.addEventListener('dragleave', () => {
                uploadContainer.classList.remove('drag-over');
            });

            uploadContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadContainer.classList.remove('drag-over');
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    loadImage(file);
                }
            });

            // Paste upload support
            document.addEventListener('paste', (e) => {
                const items = e.clipboardData.items;
                for (let i = 0; i < items.length; i++) {
                    if (items[i].type.startsWith('image/')) {
                        const file = items[i].getAsFile();
                        if (file) {
                            loadImage(file);
                        }
                        break;
                    }
                }
            });
        });

        // Load image
        function loadImage(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    state.image = img;
                    drawRoundedImage();
                    showEditor();
                    showSettings();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Show editor
        function showEditor() {
            document.getElementById('uploadContainer').style.display = 'none';
            document.getElementById('editorContainer').style.display = 'block';
        }

        // Show settings section with smooth transition
        function showSettings() {
            const settingsSection = document.getElementById('settingsSection');
            settingsSection.style.display = 'block';
            // Trigger reflow
            void settingsSection.offsetWidth;
            settingsSection.classList.add('active');
        }

        // Hide settings section
        function hideSettings() {
            const settingsSection = document.getElementById('settingsSection');
            settingsSection.classList.remove('active');
            // Wait for transition to complete before hiding
            setTimeout(() => {
                settingsSection.style.display = 'none';
            }, 300);
        }

        // Reset editor
        function resetEditor() {
            state.image = null;
            state.radius = 10;
            updateRadiusUI();
            document.getElementById('editorContainer').style.display = 'none';
            document.getElementById('uploadContainer').style.display = 'block';
            hideSettings();
        }

        // Draw rounded image on canvas
        function drawRoundedImage() {
            if (!state.image || !state.ctx) return;

            // Calculate canvas size
            let canvasWidth, canvasHeight;
            const imgRatio = state.image.width / state.image.height;
            
            // If radius is 50% (circle mode), make canvas square
            if (state.radius === 50) {
                // Create square canvas
                const squareSize = Math.min(state.containerSize, 800);
                canvasWidth = squareSize;
                canvasHeight = squareSize;
            } else {
                // Normal mode - maintain image aspect ratio
                if (imgRatio > 1) {
                    // Landscape image
                    canvasWidth = state.containerSize;
                    canvasHeight = state.containerSize / imgRatio;
                } else {
                    // Portrait or square image
                    canvasHeight = state.containerSize;
                    canvasWidth = state.containerSize * imgRatio;
                }
            }

            // Set canvas size
            state.canvas.width = canvasWidth;
            state.canvas.height = canvasHeight;
            
            // Clear canvas with transparent background
            state.ctx.clearRect(0, 0, canvasWidth, canvasHeight);

            // Calculate image draw dimensions and position
            let drawWidth, drawHeight, drawX, drawY;
            if (state.radius === 50) {
                // Circle mode - center image in square canvas
                if (imgRatio > 1) {
                    // Landscape image - fit height
                    drawHeight = canvasHeight;
                    drawWidth = drawHeight * imgRatio;
                } else {
                    // Portrait or square image - fit width
                    drawWidth = canvasWidth;
                    drawHeight = drawWidth / imgRatio;
                }
                
                // Center the image in the square canvas
                drawX = (canvasWidth - drawWidth) / 2;
                drawY = (canvasHeight - drawHeight) / 2;
            } else {
                // Normal mode - draw image to fit canvas
                drawWidth = canvasWidth;
                drawHeight = canvasHeight;
                drawX = 0;
                drawY = 0;
            }

            // Draw rounded image
            drawImageWithRoundedCorners(
                state.ctx,
                state.image,
                drawX,
                drawY,
                drawWidth,
                drawHeight,
                (state.radius / 100) * Math.min(canvasWidth, canvasHeight)
            );
        }

        // Function to draw image with rounded corners
        function drawImageWithRoundedCorners(ctx, image, x, y, width, height, radius) {
            // Save current context state
            ctx.save();
            
            // Calculate the maximum possible radius (half of the shortest side)
            const maxRadius = Math.min(width, height) / 2;
            // Ensure radius doesn't exceed the maximum possible value
            const finalRadius = Math.min(radius, maxRadius);
            
            ctx.beginPath();
            
            // For 50% radius (perfect circle), use circular path instead of rounded rectangle
            if (finalRadius === maxRadius) {
                // Draw a perfect circle centered in the rectangle
                const centerX = x + width / 2;
                const centerY = y + height / 2;
                ctx.arc(centerX, centerY, finalRadius, 0, 2 * Math.PI);
            } else {
                // Create rounded rectangle path for non-circle cases
                ctx.moveTo(x + finalRadius, y);
                ctx.lineTo(x + width - finalRadius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + finalRadius);
                ctx.lineTo(x + width, y + height - finalRadius);
                ctx.quadraticCurveTo(x + width, y + height, x + width - finalRadius, y + height);
                ctx.lineTo(x + finalRadius, y + height);
                ctx.quadraticCurveTo(x, y + height, x, y + height - finalRadius);
                ctx.lineTo(x, y + finalRadius);
                ctx.quadraticCurveTo(x, y, x + finalRadius, y);
            }
            
            ctx.closePath();
            
            // Clip to the path
            ctx.clip();
            
            // Draw the image
            ctx.drawImage(image, x, y, width, height);
            
            // Restore context state
            ctx.restore();
        }

        // Update radius UI
        function updateRadiusUI() {
            document.getElementById('radiusSlider').value = state.radius;
            document.getElementById('radiusValue').textContent = `${state.radius}%`;
            
            // Update active preview item
            document.querySelectorAll('.radius-preview-item').forEach(item => {
                item.classList.remove('active');
                if (parseInt(item.dataset.radius) === state.radius) {
                    item.classList.add('active');
                }
            });
        }

        // Radius slider event
        document.getElementById('radiusSlider').addEventListener('input', (e) => {
            state.radius = parseInt(e.target.value);
            updateRadiusUI();
            drawRoundedImage();
        });

        // Radius preview click event
        document.querySelectorAll('.radius-preview-item').forEach(item => {
            item.addEventListener('click', () => {
                state.radius = parseInt(item.dataset.radius);
                updateRadiusUI();
                drawRoundedImage();
            });
        });

        // Output size change event - handle custom size inputs
        document.getElementById('outputSize').addEventListener('change', (e) => {
            const customSizeInputs = document.getElementById('customSizeInputs');
            if (e.target.value === 'custom') {
                customSizeInputs.style.display = 'block';
            } else {
                customSizeInputs.style.display = 'none';
            }
        });

        // Download image
        function downloadImage() {
            if (!state.image) return;

            // Get settings
            const format = document.getElementById('outputFormat').value;
            const sizeOption = document.getElementById('outputSize').value;
            const quality = 0.9; // Default quality for WEBP and JPG

            // Create temporary canvas for download
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');

            const imgRatio = state.image.width / state.image.height;
            let outputWidth, outputHeight;
            
            // Calculate base output size based on selected option
            if (sizeOption === 'original') {
                outputWidth = state.image.width;
                outputHeight = state.image.height;
            } else if (sizeOption === '1080') {
                // 1080px max dimension
                if (imgRatio > 1) {
                    outputWidth = 1920; // 16:9 aspect ratio for 1080p
                    outputHeight = 1080;
                } else {
                    outputHeight = 1080;
                    outputWidth = 1080 / imgRatio;
                }
            } else if (sizeOption === 'custom') {
                // Get custom width and height from inputs
                const customWidth = parseInt(document.getElementById('customWidth').value);
                const customHeight = parseInt(document.getElementById('customHeight').value);
                outputWidth = isNaN(customWidth) ? state.image.width : customWidth;
                outputHeight = isNaN(customHeight) ? state.image.height : customHeight;
            } else {
                const size = parseInt(sizeOption);
                if (imgRatio > 1) {
                    outputWidth = size;
                    outputHeight = size / imgRatio;
                } else {
                    outputHeight = size;
                    outputWidth = size * imgRatio;
                }
            }

            // For 50% radius (circle mode), make the canvas square
            let canvasWidth, canvasHeight;
            if (state.radius === 50) {
                // Create square canvas
                canvasWidth = Math.min(outputWidth, outputHeight);
                canvasHeight = canvasWidth;
            } else {
                // Normal mode - maintain aspect ratio
                canvasWidth = outputWidth;
                canvasHeight = outputHeight;
            }

            tempCanvas.width = canvasWidth;
            tempCanvas.height = canvasHeight;

            // Clear canvas with transparent background
            tempCtx.clearRect(0, 0, canvasWidth, canvasHeight);

            // Calculate image draw dimensions and position
            let drawWidth, drawHeight, drawX, drawY;
            if (state.radius === 50) {
                // Circle mode - center image in square canvas
                if (imgRatio > 1) {
                    // Landscape image - fit height
                    drawHeight = canvasHeight;
                    drawWidth = drawHeight * imgRatio;
                } else {
                    // Portrait or square image - fit width
                    drawWidth = canvasWidth;
                    drawHeight = drawWidth / imgRatio;
                }
                
                // Center the image in the square canvas
                drawX = (canvasWidth - drawWidth) / 2;
                drawY = (canvasHeight - drawHeight) / 2;
            } else {
                // Normal mode - draw image to fit canvas
                drawWidth = canvasWidth;
                drawHeight = canvasHeight;
                drawX = 0;
                drawY = 0;
            }

            // Draw rounded image to temp canvas
            drawImageWithRoundedCorners(
                tempCtx,
                state.image,
                drawX,
                drawY,
                drawWidth,
                drawHeight,
                (state.radius / 100) * Math.min(canvasWidth, canvasHeight)
            );

            // Download
            let fileName = `rounded-corners.${format}`;
            let mimeType;
            let qualityValue = quality;

            switch (format) {
                case 'png':
                    mimeType = 'image/png';
                    qualityValue = 1; // PNG is lossless
                    break;
                case 'jpg':
                    mimeType = 'image/jpeg';
                    qualityValue = 0.85;
                    break;
                case 'webp':
                    mimeType = 'image/webp';
                    qualityValue = 0.9;
                    break;
                default:
                    mimeType = 'image/png';
                    qualityValue = 1;
            }

            tempCanvas.toBlob((blob) => {
                if (blob) {
                    downloadBlob(blob, fileName);
                }
            }, mimeType, qualityValue);
        }

        // Helper function to download blob
        function downloadBlob(blob, fileName) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize editor
        document.addEventListener('DOMContentLoaded', () => {
            initCanvas();
            updateRadiusUI();
        });
    </script>
</body>
</html>